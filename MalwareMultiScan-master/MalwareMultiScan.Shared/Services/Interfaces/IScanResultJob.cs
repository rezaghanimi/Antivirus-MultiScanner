using System;
using System.Threading.Tasks;
using Hangfire;
using MalwareMultiScan.Shared.Message;

namespace MalwareMultiScan.Shared.Services.Interfaces
{
    /// <summary>
    /// Scan background result job.
    /// </summary>
    public interface IScanResultJob
    {
        /// <summary>
        /// Report job status.
        /// </summary>
        /// <param name="resultId">Result id.</param>
        /// <param name="backendId">Backend id.</param>
        /// <param name="result">Scan result.</param>
        [AutomaticRetry(Attempts = 0, OnAttemptsExceeded = AttemptsExceededAction.Delete)]
        Task Report(string resultId, string backendId, ScanResultMessage result);

        /// <summary>
        /// Notify remote URL on scan result.
        /// </summary>
        /// <param name="uri">Base URL.</param>
        /// <param name="resultId">Result id.</param>
        /// <param name="backendId">Backend id.</param>
        /// <param name="result">Scan result.</param>
        [AutomaticRetry(Attempts = 0, OnAttemptsExceeded = AttemptsExceededAction.Delete)]
        Task Notify(Uri uri, string resultId, string backendId, ScanResultMessage result);
    }
}